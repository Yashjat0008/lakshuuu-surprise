<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>For Lakshita ‚Äî The Ultimate Surprise üååüíñ</title>
<style>
  :root{
    --bg-a: #050617;
    --bg-b: #08102a;
    --neon-1: #ff3d6b;
    --neon-2: #ff8aa2;
    --accent: #7be2ff;
    --glass: rgba(255,255,255,0.03);
    --muted: rgba(255,255,255,0.85);
    --card-w: 980px;
  }
  html,body{height:100%;margin:0;font-family:Inter, Poppins, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue";background:radial-gradient(1200px 600px at 10% 10%, rgba(20,10,40,0.35), transparent), linear-gradient(180deg,var(--bg-a), var(--bg-b) 70%);color:#fff;overflow:hidden}
  /* layout */
  .wrap{position:relative;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px;box-sizing:border-box;z-index:30}
  .card{width:var(--card-w);max-width:96%;border-radius:16px;padding:22px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 24px 80px rgba(0,0,0,0.6);backdrop-filter: blur(6px);position:relative}
  h1{margin:0;font-size:34px;letter-spacing:0.6px}
  .subtitle{margin:6px 0 12px;color:rgba(255,255,255,0.9)}
  .controls{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-top:12px}
  button.btn{padding:12px 18px;border-radius:12px;border:none;cursor:pointer;font-size:16px}
  .primary{background:linear-gradient(90deg,var(--neon-1),var(--neon-2));color:#fff;box-shadow:0 10px 40px rgba(255,61,107,0.16)}
  .ghost{background:transparent;border:2px solid rgba(255,255,255,0.06);color:#fff}
  .tiny{font-size:13px;opacity:0.95}
  /* multi-section layout */
  .area{margin-top:18px;display:grid;grid-template-columns:1fr 420px;gap:18px;align-items:start}
  .left{min-height:360px;border-radius:12px;padding:18px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.008));position:relative;overflow:hidden}
  .right{min-height:360px;border-radius:12px;padding:16px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.008));position:relative}
  /* story area */
  .story{font-size:18px;line-height:1.55;max-width:720px;color:var(--muted);text-align:left}
  .story .line{opacity:0;transform:translateY(18px);transition:all 700ms cubic-bezier(.2,.9,.2,1)}
  .story .line.show{opacity:1;transform:translateY(0)}
  .typebox{margin-top:14px;padding:12px;border-radius:10px;background:rgba(255,255,255,0.01);min-height:94px;display:flex;align-items:center}
  .typed{font-size:18px}
  /* journey area */
  .stage-area{margin-top:8px;min-height:220px;border-radius:12px;padding:14px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.008));position:relative;overflow:hidden}
  .msg{max-width:760px;font-size:20px;line-height:1.5;text-align:center;opacity:0;transform:translateY(18px);transition:all 600ms cubic-bezier(.2,.9,.2,1)}
  .msg.show{opacity:1;transform:translateY(0)}
  .stage-index{position:absolute;top:12px;left:14px;font-size:13px;color:rgba(255,255,255,0.55)}
  /* neon heart / 3D */
  .neon-heart{position:relative;width:120px;height:120px;margin:6px auto;border-radius:50%;display:flex;align-items:center;justify-content:center;filter:drop-shadow(0 20px 60px rgba(255,61,107,0.14))}
  .neon-heart .core{font-size:46px;animation:beat 1300ms ease-in-out infinite;transform-origin:center}
  @keyframes beat{0%{transform:scale(1)}25%{transform:scale(1.14)}50%{transform:scale(1)}75%{transform:scale(1.08)}100%{transform:scale(1)}}
  .ring{position:absolute;inset:-6px;border-radius:50%;filter:blur(12px);background:conic-gradient(from 0deg, rgba(255,62,108,0.12), rgba(123,226,255,0.06));animation:spin 16s linear infinite;z-index:-1}
  @keyframes spin{to{transform:rotate(360deg)}}
  /* sparkles & mini UI */
  .tiny-hint{font-size:13px;color:rgba(255,255,255,0.75);text-align:center;margin-top:8px}
  /* final reveal */
  .final-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:260;padding:20px;background:linear-gradient(180deg, rgba(2,6,15,0.7), rgba(2,6,12,0.9))}
  .final-card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:26px;border-radius:14px;text-align:center;max-width:760px;box-shadow:0 18px 60px rgba(0,0,0,0.6)}
  .final-title{font-size:30px;margin:6px 0}
  .final-text{font-size:18px;margin:10px 0 14px}
  /* responsive */
  @media(max-width:980px){ .area{grid-template-columns:1fr}.right{order:2} .left{order:1} }
  @media(max-width:640px){h1{font-size:24px}.story{font-size:16px}.msg{font-size:18px}}
  /* canvas layers */
  canvas{position:fixed;inset:0;z-index:5;pointer-events:none}
</style>
</head>
<body>

<!-- canvases for FX -->
<canvas id="bgStars"></canvas>
<canvas id="particles"></canvas>
<canvas id="rings"></canvas>
<canvas id="confetti"></canvas>

<div class="wrap" role="main" aria-label="Ultimate surprise for Lakshita">
  <div class="card" role="region" aria-labelledby="title">
    <h1 id="title">For Lakshita ‚ù§Ô∏è ‚Äî A Journey & A Show</h1>
    <div class="subtitle">A combined love-story + ultra-animation + staged message journey. Tap <strong>Begin</strong> to start the cinematic experience. üåå‚ú®</div>

    <div class="controls" style="justify-content:center">
      <button id="beginBtn" class="btn primary">Begin the Journey ‚ú®</button>
      <button id="storyBtn" class="btn ghost">Love Story Mode üìñ</button>
      <button id="showBtn" class="btn ghost">Animation Show üå†</button>
      <button id="replayBtn" class="btn ghost">Replay All üîÅ</button>
    </div>

    <div class="area" style="margin-top:16px">
      <div class="left" aria-live="polite" id="leftArea">
        <div class="story" id="storyArea">
          <!-- story lines injected -->
        </div>

        <div class="typebox" style="margin-top:14px">
          <div class="typed" id="typedShort">Tap a mode to see more ‚Äî or press Begin.</div>
        </div>

        <div class="tiny-hint">Tip: Use headphones for best cinematic effect. If autoplay is blocked, press Begin then Show/Story manually.</div>
      </div>

      <div class="right">
        <div style="display:flex;align-items:center;justify-content:center;flex-direction:column">
          <div class="neon-heart" aria-hidden="true">
            <div class="ring"></div>
            <div class="core" id="neonCore">üíñ</div>
          </div>

          <div class="stage-area" id="stageArea" aria-live="polite" aria-atomic="true">
            <div class="stage-index" id="stageIndex">Stage 0 / 0</div>
            <div class="msg" id="msgBox">Press Begin to start the staged message journey.</div>
          </div>

          <div style="display:flex;gap:10px;margin-top:12px;justify-content:center">
            <button id="prevBtn" class="btn ghost" disabled>‚Üê Prev</button>
            <button id="nextBtn" class="btn primary" disabled>Next ‚Üí</button>
            <button id="endBtn" class="btn ghost" disabled>Final Reveal üéá</button>
          </div>
        </div>
      </div>
    </div>

    <div style="margin-top:12px;text-align:center;color:rgba(255,255,255,0.65);font-size:13px">Want a specific final line or inside joke added? Tell me and I'll update the file.</div>
  </div>
</div>

<!-- final modal -->
<div class="final-modal" id="finalModal" role="dialog" aria-modal="true">
  <div class="final-card" role="document">
    <div class="final-title">Lakshita ‚Äî Will you give me a chance? ü•∫</div>
    <div class="final-text" id="finalMsg">I know I messed up. I miss us and I'll change. Can we try again?</div>
    <div style="display:flex;gap:12px;justify-content:center;margin-top:12px">
      <button id="yesBtn" class="btn primary">Yes ‚Äî let's talk ‚ù§Ô∏è</button>
      <button id="noBtn" class="btn ghost">I need time üí≠</button>
    </div>
  </div>
</div>

<!-- audio -->
<audio id="sfxType" preload="auto">
  <source src="https://cdn.pixabay.com/download/audio/2021/08/08/audio_6b7fb1e3a2.mp3?filename=ui-click-12631.mp3" type="audio/mpeg">
</audio>
<audio id="sfxBell" preload="auto">
  <source src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_40f9f1c0d8.mp3?filename=magic-chime-110560.mp3" type="audio/mpeg">
</audio>
<audio id="bgMusic" loop preload="auto">
  <source src="https://cdn.pixabay.com/download/audio/2022/02/05/audio_8c8a6a8f7b.mp3?filename=romantic-ambient-110218.mp3" type="audio/mpeg">
</audio>

<script>
/* -----------------------
   CONFIG & TEXT
   ----------------------- */
const NAME = "Lakshita";
const THEME = "GALAXY_NEON"; // chosen theme
const STORY_LINES = [
  "It started like any other day ‚Äî but with you, even the small things felt special.",
  "I remember our laughter, the midnight talks, the silly fights that felt like tiny storms.",
  "Somewhere along the way I hurt you, and that thought hasn't left me since.",
  "This is my little attempt to say ‚Äî I'm sorry, I miss you, and I want to make things right.",
  "If you'll let me, I'll start with one talk, one coffee, one small step to win you back."
];
const JOURNEY_STAGES = [
  { title: "I know things went wrong", text: `Hey ${NAME}, I know I made mistakes and I'm truly sorry.`, style: 'type' },
  { title: "I miss the old us", text: `I miss our laughs, our silly jokes, the midnight talks ‚Äî I miss you.` , style:'fade' },
  { title: "I really care", text: `You mean so much to me. Your smile, your voice ‚Äî they stay with me all day.`, style:'neon' },
  { title: "I want to fix things", text: `I'm ready to listen and change. Tell me how I can make it better.`, style:'shake' },
  { title: "Will you give me a chance?", text: `If you're willing, let's start small. One talk. One step. I'll wait and prove it.`, style:'final' }
];
const TOTAL = JOURNEY_STAGES.length;
const AUTOPLAY = true;
/* -----------------------
   END CONFIG
   ----------------------- */

/* DOM */
const beginBtn = document.getElementById('beginBtn');
const storyBtn = document.getElementById('storyBtn');
const showBtn = document.getElementById('showBtn');
const replayBtn = document.getElementById('replayBtn');
const typedShort = document.getElementById('typedShort');
const storyArea = document.getElementById('storyArea');

const nextBtn = document.getElementById('nextBtn');
const prevBtn = document.getElementById('prevBtn');
const endBtn = document.getElementById('endBtn');
const msgBox = document.getElementById('msgBox');
const stageIndex = document.getElementById('stageIndex');
const neonCore = document.getElementById('neonCore');
const finalModal = document.getElementById('finalModal');
const yesBtn = document.getElementById('yesBtn');
const noBtn = document.getElementById('noBtn');

const sfxType = document.getElementById('sfxType');
const sfxBell = document.getElementById('sfxBell');
const bgMusic = document.getElementById('bgMusic');

/* FX canvases */
const canvasStars = document.getElementById('bgStars');
const canvasParticles = document.getElementById('particles');
const canvasRings = document.getElementById('rings');
const canvasConfetti = document.getElementById('confetti');

let ctxStars = canvasStars.getContext('2d');
let ctxParticles = canvasParticles.getContext('2d');
let ctxRings = canvasRings.getContext('2d');
let ctxConf = canvasConfetti.getContext('2d');

/* resize canvases */
function resizeAll(){ [canvasStars,canvasParticles,canvasRings,canvasConfetti].forEach(c=>{ c.width=innerWidth; c.height=innerHeight; }); }
resizeAll(); window.addEventListener('resize', resizeAll);

/* -----------------------
   Background FX: stars, particles, rings
   ----------------------- */
let stars = [];
function initStars(){
  stars = [];
  const count = Math.floor(innerWidth/6);
  for(let i=0;i<count;i++){
    stars.push({ x:Math.random()*innerWidth, y:Math.random()*innerHeight, r:Math.random()*1.6, a:0.2+Math.random()*0.9, da:0.002+Math.random()*0.01, hue: 230+Math.random()*80 });
  }
}
function drawStars(){
  ctxStars.clearRect(0,0,canvasStars.width,canvasStars.height);
  for(const s of stars){
    s.a += (Math.random()>0.5?1:-1)*s.da;
    if(s.a<0.05) s.a=0.05; if(s.a>1) s.a=1;
    ctxStars.globalAlpha = s.a;
    ctxStars.fillStyle = `hsl(${s.hue} 80% 85%)`;
    ctxStars.beginPath(); ctxStars.arc(s.x,s.y,s.r,0,Math.PI*2); ctxStars.fill();
  }
  ctxStars.globalAlpha = 1;
  requestAnimationFrame(drawStars);
}
initStars(); drawStars();

/* floating particle orbs */
let orbs = [];
function initOrbs(){
  orbs = [];
  for(let i=0;i<60;i++){
    orbs.push({ x:Math.random()*innerWidth, y:Math.random()*innerHeight, r:10+Math.random()*48, dx:(-0.2+Math.random()*0.4), dy:(-0.1+Math.random()*0.2), hue:190+Math.random()*120, alpha:0.06+Math.random()*0.12 });
  }
}
function drawOrbs(){
  ctxParticles.clearRect(0,0,canvasParticles.width,canvasParticles.height);
  for(const p of orbs){
    p.x += p.dx; p.y += p.dy;
    if(p.x < -200) p.x = innerWidth+200;
    if(p.x > innerWidth+200) p.x = -200;
    const g = ctxParticles.createRadialGradient(p.x,p.y,p.r*0.02,p.x,p.y,p.r);
    g.addColorStop(0, `hsla(${p.hue},90%,66%,${p.alpha})`);
    g.addColorStop(0.6, `hsla(${p.hue},90%,46%,${p.alpha*0.35})`);
    g.addColorStop(1, `hsla(${p.hue},90%,36%,0)`);
    ctxParticles.fillStyle = g; ctxParticles.beginPath(); ctxParticles.arc(p.x,p.y,p.r,0,Math.PI*2); ctxParticles.fill();
  }
  requestAnimationFrame(drawOrbs);
}
initOrbs(); drawOrbs();

/* rotating neon rings */
let rings = [];
function initRings(){
  rings = [];
  for(let i=0;i<5;i++){
    rings.push({ x:innerWidth*(0.2+Math.random()*0.6), y:innerHeight*(0.2+Math.random()*0.6), r:80+Math.random()*220, w:1+Math.random()*3, rot:Math.random()*Math.PI*2, speed:(0.0008+Math.random()*0.002), hue:320+Math.random()*60 });
  }
}
function drawRings(){
  ctxRings.clearRect(0,0,canvasRings.width,canvasRings.height);
  for(const rg of rings){
    rg.rot += rg.speed;
    ctxRings.save();
    ctxRings.translate(rg.x,rg.y); ctxRings.rotate(rg.rot);
    const grad = ctxRings.createLinearGradient(-rg.r,-rg.r,rg.r,rg.r);
    grad.addColorStop(0, `hsla(${rg.hue} 90% 68% / 0.06)`);
    grad.addColorStop(1, `hsla(${rg.hue+40} 90% 68% / 0.02)`);
    ctxRings.strokeStyle = grad; ctxRings.lineWidth = rg.w;
    ctxRings.beginPath(); ctxRings.arc(0,0,rg.r,0,Math.PI*2); ctxRings.stroke();
    ctxRings.restore();
  }
  requestAnimationFrame(drawRings);
}
initRings(); drawRings();

/* -----------------------
   Confetti / firework layer
   ----------------------- */
let confetti = [];
function burstConfetti(mult=1){
  for(let i=0;i<110*mult;i++){
    confetti.push({
      x: Math.random()*innerWidth,
      y: -10 - Math.random()*200,
      vx: -3 + Math.random()*6,
      vy: 1 + Math.random()*6,
      r: 6 + Math.random()*10,
      ang: Math.random()*360,
      dang: (-0.06 + Math.random()*0.12),
      color: `hsl(${Math.floor(Math.random()*360)} 85% 60%)`,
      life: 150 + Math.random()*180
    });
  }
  animateConfetti();
}
function animateConfetti(){
  ctxConf.clearRect(0,0,canvasConfetti.width,canvasConfetti.height);
  for(let i=confetti.length-1;i>=0;i--){
    const p = confetti[i];
    p.x += p.vx; p.y += p.vy; p.vy += 0.08; p.ang += p.dang; p.life--;
    ctxConf.save(); ctxConf.translate(p.x,p.y); ctxConf.rotate(p.ang);
    ctxConf.fillStyle = p.color; ctxConf.fillRect(-p.r/2, -p.r/2, p.r, p.r*0.62); ctxConf.restore();
    if(p.life<=0 || p.y > canvasConfetti.height+300) confetti.splice(i,1);
  }
  if(confetti.length>0) requestAnimationFrame(animateConfetti);
}

/* quick fireworks booster */
let fireworks = [];
function createFireworkBurst(n=6){
  for(let k=0;k<n;k++){
    const cx = Math.random()*(innerWidth*0.8)+innerWidth*0.1;
    const cy = Math.random()*(innerHeight*0.6)+innerHeight*0.05;
    const col = `hsl(${Math.floor(Math.random()*360)} 90% 65%)`;
    const count = 36 + Math.floor(Math.random()*40);
    for(let i=0;i<count;i++){
      fireworks.push({
        x: cx, y: cy,
        vx: Math.cos(i/count*Math.PI*2) * (2+Math.random()*6),
        vy: Math.sin(i/count*Math.PI*2) * (2+Math.random()*6),
        life: 40 + Math.random()*40, color: col, size: 1 + Math.random()*3
      });
    }
  }
  drawFireworks();
}
function drawFireworks(){
  ctxConf.globalCompositeOperation = 'lighter';
  (function frame(){
    ctxConf.clearRect(0,0,canvasConfetti.width,canvasConfetti.height);
    for(let i=fireworks.length-1;i>=0;i--){
      const p = fireworks[i];
      p.x += p.vx; p.y += p.vy; p.vy += 0.06; p.life--;
      ctxConf.globalAlpha = Math.max(0, p.life/60);
      ctxConf.fillStyle = p.color;
      ctxConf.beginPath(); ctxConf.arc(p.x,p.y, p.size, 0, Math.PI*2); ctxConf.fill();
      if(p.life<=0) fireworks.splice(i,1);
    }
    if(fireworks.length>0) requestAnimationFrame(frame); else ctxConf.globalCompositeOperation = 'source-over';
  })();
}

/* -----------------------
   STORY MODE: typed + line animations
   ----------------------- */
const storyAreaEl = document.getElementById('storyArea');
function renderStoryLines(){
  storyAreaEl.innerHTML = '';
  STORY_LINES.forEach((ln, idx) => {
    const div = document.createElement('div'); div.className = 'line'; div.innerText = ln;
    storyAreaEl.appendChild(div);
  });
}
async function playStory(){
  renderStoryLines();
  const lines = Array.from(storyAreaEl.querySelectorAll('.line'));
  for(let i=0;i<lines.length;i++){
    // subtle star/spark effect every line
    spawnTinySparkles();
    await wait(220);
    lines[i].classList.add('show');
    try{ sfxBell.currentTime = 0; sfxBell.play(); }catch(e){}
    await wait(900 + i*120);
  }
  // finish with small ring and confetti
  createFireworkBurst(6); burstConfetti(1);
}

/* small sparkle burst near center */
function spawnTinySparkles(count=18){
  const x = innerWidth/2 + (Math.random()*120 - 60);
  const y = innerHeight/2 + (Math.random()*60 - 30);
  for(let i=0;i<count;i++){
    setTimeout(()=> createTransientParticle(x + Math.random()*120 - 60, y + Math.random()*60 - 30, 2 + Math.random()*6), i*12);
  }
}
function createTransientParticle(x,y,r){
  const p = { x, y, r, dx: (Math.random()*6-3), dy:(Math.random()*-6-1), life:80, color:`hsl(${340 + Math.random()*40} 90% 66%)` };
  const id = setInterval(()=> {
    p.x += p.dx; p.y += p.dy; p.dy += 0.18; p.life--;
    ctxConf.fillStyle = p.color; ctxConf.beginPath(); ctxConf.arc(p.x,p.y,p.r,0,Math.PI*2); ctxConf.fill();
    if(p.life<=0){ clearInterval(id); }
  }, 16);
}

/* -----------------------
   MESSAGE JOURNEY: typing, fade, neon, shake, final
   ----------------------- */
let cur = -1;
function setStage(i){
  if(i<0 || i>=TOTAL) return;
  cur = i; stageIndex.innerText = `Stage ${i+1} / ${TOTAL}`;
  msgBox.classList.remove('show'); msgBox.style.opacity = 0; msgBox.style.transform = 'translateY(18px)';
  msgBox.innerHTML = '';
  const st = JOURNEY_STAGES[i];
  // pre effect
  spawnTinySparkles(12);
  if(st.style === 'type'){
    typeText(msgBox, st.text, 36).then(()=> { msgBox.classList.add('show'); try{ sfxBell.currentTime=0; sfxBell.play(); }catch(e){};});
  } else if(st.style === 'fade'){
    msgBox.innerText = st.text; setTimeout(()=>{ msgBox.classList.add('show'); }, 40);
  } else if(st.style === 'neon'){
    msgBox.innerHTML = `<strong style="text-shadow:0 0 18px rgba(255,60,110,0.4)">${st.text}</strong>`;
    setTimeout(()=>{ msgBox.classList.add('show'); neonFlash(msgBox,6); }, 40);
  } else if(st.style === 'shake'){
    msgBox.innerText = st.text; setTimeout(()=>{ msgBox.classList.add('show'); shake(msgBox, 10, 900); }, 40);
  } else if(st.style === 'final'){
    msgBox.innerHTML = `<strong>${st.text}</strong>`; setTimeout(()=>{ msgBox.classList.add('show'); }, 80);
    setTimeout(()=> openFinalModal(), 1800);
  } else {
    msgBox.innerText = st.text; setTimeout(()=> msgBox.classList.add('show'), 40);
  }
}

/* typing utility */
function typeText(el, text, speed=40){
  return new Promise(async (res)=>{
    el.innerHTML = '';
    for(let i=0;i<=text.length;i++){
      el.innerHTML = `<span>${escapeHtml(text.slice(0,i))}</span><span style="opacity:${i%2?1:0.3}">|</span>`;
      try{ sfxType.currentTime = 0; sfxType.play(); }catch(e){}
      await wait(speed);
    }
    el.innerHTML = `<span>${escapeHtml(text)}</span>`;
    res();
  });
}

/* helpers */
function wait(ms){ return new Promise(r=>setTimeout(r,ms)); }
function escapeHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
function neonFlash(el, times=3){ let t=0; const iv=setInterval(()=>{ el.style.textShadow = `0 0 ${6 + (t%2?10:2)}px rgba(255,90,130,${0.7 - t*0.05})`; t++; if(t>times*2){ clearInterval(iv); el.style.textShadow=''; } }, 220); }
function shake(el, magnitude=8, duration=600){ const start=Date.now(), orig=el.style.transform||''; (function tick(){ const now=Date.now(), p=(now-start)/duration; if(p>=1){ el.style.transform=orig; return; } const s=(Math.sin(p*20)*(1-p)*magnitude); el.style.transform=`translateX(${s}px)`; requestAnimationFrame(tick); })(); }

/* final modal */
function openFinalModal(){
  finalModal.style.display='flex';
  burstConfetti(1);
  createFireworkBurst(6);
}

/* handle yes/no */
yesBtn.addEventListener('click', ()=>{
  document.getElementById('finalMsg').innerText = "Thank you ‚Äî this means everything. I'll make it right. üíû";
  yesBtn.disabled = true; yesBtn.classList.add('primary');
  burstConfetti(2); createFireworkBurst(6);
});
noBtn.addEventListener('click', ()=>{
  document.getElementById('finalMsg').innerText = "I understand. I'll wait and try my best. Take all the time you need. üå±";
  noBtn.disabled = true;
});

/* -----------------------
   UI wiring: Begin / Story / Show / Replay
   ----------------------- */
beginBtn.addEventListener('click', async ()=>{
  // autoplay music
  try{ if(AUTOPLAY) bgMusic.play().catch(()=>{}); }catch(e){}
  // start combined sequence: story then journey with show interludes
  typedShort.innerText = "Playing the full cinematic journey...";
  await wait(450);
  // Story mode
  await playStory();
  await wait(600);
  // Small show burst
  createFireworkBurst(4); burstConfetti(1);
  await wait(800);
  // Initialize journey
  enableJourney();
  setStage(0);
});

storyBtn.addEventListener('click', async ()=>{ typedShort.innerText = "Playing Love Story Mode..."; await playStory(); });

showBtn.addEventListener('click', async ()=>{ typedShort.innerText = "Playing Animation Show..."; createFireworkBurst(6); burstConfetti(1); spawnTinySparkles(30); });

replayBtn.addEventListener('click', async ()=>{ // reset visual FX lightly
  confetti = []; fireworks = []; initRings(); initOrbs(); initStars();
  typedShort.innerText = "Replaying everything. Press Begin.";
  try{ bgMusic.currentTime = 0; bgMusic.play().catch(()=>{}); }catch(e){}
});

/* journey nav */
function enableJourney(){ nextBtn.disabled=false; prevBtn.disabled=false; endBtn.disabled=false; stageIndex.innerText = `Stage 0 / ${TOTAL}`; }
nextBtn.addEventListener('click', async ()=>{ if(cur < TOTAL-1) setStage(cur+1); });
prevBtn.addEventListener('click', async ()=>{ if(cur > 0) setStage(cur-1); });
endBtn.addEventListener('click', ()=> openFinalModal());

/* keyboard nav */
document.addEventListener('keydown', (e)=>{ if(e.key==='ArrowRight') nextBtn.click(); if(e.key==='ArrowLeft') prevBtn.click(); if(e.key==='Escape') { finalModal.style.display='none'; } });

/* unlock audio on first click */
document.addEventListener('click', function unlock(){ try{ if(AUTOPLAY) bgMusic.play().catch(()=>{}); }catch(e){}; document.removeEventListener('click', unlock); });

/* initial small sparkles */
setTimeout(()=> spawnTinySparkles(14), 700);

/* Expose debug */
window.__ultimate = { burstConfetti, createFireworkBurst };

/* end script */
</script>

</body>
</html>
